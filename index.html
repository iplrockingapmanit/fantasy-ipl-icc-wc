<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rocking Fantasy WCT20 2026</title>
<link href="https://fonts.googleapis.com/css2?family=Oswald:wght@400;500;600;700&family=Barlow:wght@300;400;500;600;700&family=Barlow+Condensed:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
  :root {
    --bg-dark: #0a0e17;
    --bg-card: #111827;
    --bg-card-hover: #1a2336;
    --accent-gold: #f5a623;
    --accent-cyan: #22d3ee;
    --accent-emerald: #10b981;
    --accent-rose: #f43f5e;
    --accent-violet: #8b5cf6;
    --text-primary: #f1f5f9;
    --text-secondary: #94a3b8;
    --text-muted: #64748b;
    --border: #1e293b;
    --glass: rgba(17, 24, 39, 0.7);
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Barlow', sans-serif;
    background: var(--bg-dark);
    color: var(--text-primary);
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Animated background */
  body::before {
    content: '';
    position: fixed;
    top: 0; left: 0; right: 0; bottom: 0;
    background: 
      radial-gradient(ellipse 80% 50% at 20% 20%, rgba(34, 211, 238, 0.06) 0%, transparent 60%),
      radial-gradient(ellipse 60% 40% at 80% 80%, rgba(139, 92, 246, 0.06) 0%, transparent 60%),
      radial-gradient(ellipse 50% 30% at 50% 50%, rgba(245, 166, 35, 0.04) 0%, transparent 60%);
    z-index: 0;
    animation: bgPulse 8s ease-in-out infinite alternate;
  }

  @keyframes bgPulse {
    0% { opacity: 0.6; }
    100% { opacity: 1; }
  }

  .container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 0 20px;
    position: relative;
    z-index: 1;
  }

  /* Header */
  .header {
    text-align: center;
    padding: 40px 0 20px;
    position: relative;
  }

  .header::after {
    content: '';
    position: absolute;
    bottom: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 120px;
    height: 2px;
    background: linear-gradient(90deg, transparent, var(--accent-gold), transparent);
  }

  .tournament-badge {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    background: linear-gradient(135deg, rgba(245, 166, 35, 0.15), rgba(245, 166, 35, 0.05));
    border: 1px solid rgba(245, 166, 35, 0.3);
    border-radius: 50px;
    padding: 6px 18px;
    font-family: 'Barlow Condensed', sans-serif;
    font-weight: 600;
    font-size: 13px;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--accent-gold);
    margin-bottom: 16px;
    animation: fadeInDown 0.6s ease;
  }

  .tournament-badge .dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    background: var(--accent-emerald);
    animation: livePulse 1.5s ease-in-out infinite;
  }

  @keyframes livePulse {
    0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(16, 185, 129, 0.4); }
    50% { opacity: 0.6; box-shadow: 0 0 0 6px rgba(16, 185, 129, 0); }
  }

  .header h1 {
    font-family: 'Oswald', sans-serif;
    font-size: clamp(36px, 6vw, 64px);
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 3px;
    background: linear-gradient(135deg, #ffffff 0%, #f5a623 50%, #22d3ee 100%);
    background-size: 200% 200%;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    background-clip: text;
    animation: gradientShift 4s ease infinite, fadeInDown 0.8s ease;
    line-height: 1.1;
  }

  @keyframes gradientShift {
    0%, 100% { background-position: 0% 50%; }
    50% { background-position: 100% 50%; }
  }

  @keyframes fadeInDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .header .subtitle {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 15px;
    color: var(--text-muted);
    letter-spacing: 1.5px;
    margin-top: 8px;
    animation: fadeInDown 1s ease;
  }

  .header .subtitle span {
    color: var(--accent-cyan);
    font-weight: 600;
  }

  /* Week info bar */
  .week-bar {
    display: flex;
    justify-content: center;
    gap: 24px;
    flex-wrap: wrap;
    margin: 24px 0 32px;
    animation: fadeIn 1s ease 0.3s both;
  }

  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }

  .week-stat {
    display: flex;
    align-items: center;
    gap: 8px;
    font-size: 13px;
    color: var(--text-secondary);
    font-weight: 500;
  }

  .week-stat .icon {
    font-size: 16px;
  }

  .week-stat .value {
    color: var(--text-primary);
    font-weight: 700;
    font-family: 'Oswald', sans-serif;
    font-size: 15px;
  }

  /* Podium Section */
  .podium-section {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 16px;
    margin: 10px 0 40px;
    padding: 0 20px;
  }

  .podium-card {
    flex: 0 1 220px;
    text-align: center;
    cursor: pointer;
    transition: transform 0.3s ease;
    animation: podiumRise 0.8s ease both;
  }

  .podium-card:nth-child(1) { animation-delay: 0.4s; }
  .podium-card:nth-child(2) { animation-delay: 0.2s; }
  .podium-card:nth-child(3) { animation-delay: 0.6s; }

  @keyframes podiumRise {
    from { opacity: 0; transform: translateY(40px); }
    to { opacity: 1; transform: translateY(0); }
  }

  .podium-card:hover { transform: translateY(-4px); }

  .podium-inner {
    border-radius: 16px;
    padding: 24px 16px 20px;
    position: relative;
    overflow: hidden;
    border: 1px solid var(--border);
    background: var(--bg-card);
  }

  .podium-card.gold .podium-inner {
    border-color: rgba(245, 166, 35, 0.4);
    background: linear-gradient(180deg, rgba(245, 166, 35, 0.1) 0%, var(--bg-card) 60%);
  }

  .podium-card.silver .podium-inner {
    border-color: rgba(148, 163, 184, 0.3);
    background: linear-gradient(180deg, rgba(148, 163, 184, 0.08) 0%, var(--bg-card) 60%);
  }

  .podium-card.bronze .podium-inner {
    border-color: rgba(217, 119, 6, 0.3);
    background: linear-gradient(180deg, rgba(217, 119, 6, 0.08) 0%, var(--bg-card) 60%);
  }

  .podium-rank {
    font-family: 'Oswald', sans-serif;
    font-size: 40px;
    font-weight: 700;
    line-height: 1;
    margin-bottom: 8px;
  }

  .gold .podium-rank { color: var(--accent-gold); }
  .silver .podium-rank { color: #94a3b8; }
  .bronze .podium-rank { color: #d97706; }

  .podium-name {
    font-family: 'Oswald', sans-serif;
    font-size: 22px;
    font-weight: 600;
    text-transform: uppercase;
    letter-spacing: 1px;
    margin-bottom: 4px;
  }

  .podium-points {
    font-family: 'Oswald', sans-serif;
    font-size: 36px;
    font-weight: 700;
    margin: 4px 0;
  }

  .gold .podium-points { color: var(--accent-gold); }
  .silver .podium-points { color: var(--accent-cyan); }
  .bronze .podium-points { color: var(--accent-emerald); }

  .podium-slots {
    font-size: 11px;
    color: var(--text-muted);
    text-transform: uppercase;
    letter-spacing: 1px;
    font-weight: 600;
  }

  /* Tabs */
  .tabs {
    display: flex;
    justify-content: center;
    gap: 4px;
    margin-bottom: 24px;
    background: var(--bg-card);
    border-radius: 12px;
    padding: 4px;
    max-width: 500px;
    margin-left: auto;
    margin-right: auto;
    border: 1px solid var(--border);
  }

  .tab-btn {
    flex: 1;
    padding: 10px 16px;
    border: none;
    background: transparent;
    color: var(--text-muted);
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 14px;
    font-weight: 600;
    letter-spacing: 1px;
    text-transform: uppercase;
    cursor: pointer;
    border-radius: 8px;
    transition: all 0.3s ease;
  }

  .tab-btn.active {
    background: linear-gradient(135deg, rgba(245, 166, 35, 0.2), rgba(34, 211, 238, 0.1));
    color: var(--text-primary);
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);
  }

  .tab-btn:hover:not(.active) {
    color: var(--text-secondary);
  }

  /* Leaderboard Table */
  .leaderboard-panel, .squads-panel {
    animation: fadeIn 0.4s ease;
  }

  .leaderboard-table {
    width: 100%;
    border-collapse: separate;
    border-spacing: 0 6px;
    margin-bottom: 40px;
  }

  .leaderboard-table thead th {
    font-family: 'Barlow Condensed', sans-serif;
    font-size: 11px;
    letter-spacing: 1.5px;
    text-transform: uppercase;
    color: var(--text-muted);
    padding: 8px 16px;
    text-align: left;
    font-weight: 600;
  }

  .leaderboard-table thead th:nth-child(3),
  .leaderboard-table thead th:nth-child(4),
  .leaderboard-table thead th:nth-child(5) {
    text-align: center;
  }

  .leaderboard-table tbody tr {
    background: var(--bg-card);
    cursor: pointer;
    transition: all 0.2s ease;
    animation: rowSlide 0.5s ease both;
  }

  .leaderboard-table tbody tr:nth-child(1) { animation-delay: 0.1s; }
  .leaderboard-table tbody tr:nth-child(2) { animation-delay: 0.15s; }
  .leaderboard-table tbody tr:nth-child(3) { animation-delay: 0.2s; }
  .leaderboard-table tbody tr:nth-child(4) { animation-delay: 0.25s; }
  .leaderboard-table tbody tr:nth-child(5) { animation-delay: 0.3s; }
  .leaderboard-table tbody tr:nth-child(6) { animation-delay: 0.35s; }
  .leaderboard-table tbody tr:nth-child(7) { animation-delay: 0.4s; }
  .leaderboard-table tbody tr:nth-child(8) { animation-delay: 0.45s; }
  .leaderboard-table tbody tr:nth-child(9) { animation-delay: 0.5s; }

  @keyframes rowSlide {
    from { opacity: 0; transform: translateX(-20px); }
    to { opacity: 1; transform: translateX(0); }
  }

  .leaderboard-table tbody tr:hover {
    background: var(--bg-card-hover);
    transform: scale(1.005);
  }

  .leaderboard-table td {
    padding: 14px 16px;
    font-size: 14px;
    border-top: 1px solid transparent;
    border-bottom: 1px solid transparent;
  }

  .leaderboard-table td:first-child {
    border-radius: 10px 0 0 10px;
    border-left: 1px solid transparent;
  }

  .leaderboard-table td:last-child {
    border-radius: 0 10px 10px 0;
    border-right: 1px solid transparent;
  }

  .leaderboard-table tbody tr:hover td {
    border-color: var(--border);
  }

  .rank-cell {
    font-family: 'Oswald', sans-serif;
    font-weight: 700;
    font-size: 18px;
    color: var(--text-muted);
    width: 50px;
  }

  .rank-cell.top3 { color: var(--accent-gold); }

  .manager-cell {
    font-family: 'Oswald', sans-serif;
    font-weight: 600;
    font-size: 16px;
    text-transform: uppercase;
    letter-spacing: 0.5px;
  }

  .points-cell {
    text-align: center;
    font-family: 'Oswald', sans-serif;
    font-weight: 700;
    font-size: 20px;
    color: var(--accent-cyan);
  }

  .total-points-cell {
    text-align: center;
    font-family: 'Oswald', sans-serif;
    font-weight: 500;
    font-size: 16px;
    color: var(--text-secondary);
  }

  .slots-cell {
    text-align: center;
    font-size: 13px;
    color: var(--text-muted);
  }

  .slots-bar {
    display: flex;
    gap: 3px;
    justify-content: center;
  }

  .slot-pip {
    width: 8px;
    height: 8px;
    border-radius: 2px;
    background: var(--border);
  }

  .slot-pip.used {
    background: var(--accent-emerald);
  }

  .points-bar {
    width: 100%;
    max-width: 120px;
    height: 4px;
    background: var(--border);
    border-radius: 2px;
    overflow: hidden;
    margin: 4px auto 0;
  }

  .points-bar-fill {
    height: 100%;
    border-radius: 2px;
    background: linear-gradient(90deg, var(--accent-cyan), var(--accent-emerald));
    transition: width 1s ease;
  }

  /* Squad Cards */
  .squads-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
    gap: 16px;
    margin-bottom: 40px;
  }

  .squad-card {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 14px;
    overflow: hidden;
    transition: all 0.3s ease;
    animation: fadeIn 0.5s ease both;
  }

  .squad-card:hover {
    border-color: rgba(245, 166, 35, 0.2);
    transform: translateY(-2px);
    box-shadow: 0 8px 24px rgba(0, 0, 0, 0.3);
  }

  .squad-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 16px 20px;
    border-bottom: 1px solid var(--border);
    background: linear-gradient(135deg, rgba(245, 166, 35, 0.05), transparent);
  }

  .squad-header-left {
    display: flex;
    align-items: center;
    gap: 12px;
  }

  .squad-rank-badge {
    font-family: 'Oswald', sans-serif;
    font-weight: 700;
    font-size: 14px;
    color: var(--text-muted);
    background: rgba(255,255,255,0.05);
    width: 32px;
    height: 32px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .squad-card:nth-child(1) .squad-rank-badge,
  .squad-card:nth-child(2) .squad-rank-badge,
  .squad-card:nth-child(3) .squad-rank-badge {
    color: var(--accent-gold);
    background: rgba(245, 166, 35, 0.1);
  }

  .squad-manager-name {
    font-family: 'Oswald', sans-serif;
    font-weight: 600;
    font-size: 18px;
    text-transform: uppercase;
    letter-spacing: 1px;
  }

  .squad-total {
    font-family: 'Oswald', sans-serif;
    font-weight: 700;
    font-size: 24px;
    color: var(--accent-gold);
  }

  .squad-total small {
    font-size: 11px;
    color: var(--text-muted);
    font-weight: 500;
    display: block;
    letter-spacing: 1px;
  }

  .squad-players {
    padding: 8px 0;
  }

  .squad-player {
    display: flex;
    align-items: center;
    padding: 10px 20px;
    transition: background 0.2s;
  }

  .squad-player:hover {
    background: rgba(255,255,255,0.02);
  }

  .player-name {
    flex: 1;
    font-size: 14px;
    font-weight: 500;
    color: var(--text-secondary);
  }

  .player-points {
    font-family: 'Oswald', sans-serif;
    font-weight: 600;
    font-size: 18px;
    color: var(--text-primary);
    min-width: 50px;
    text-align: right;
  }

  .player-slots {
    display: flex;
    gap: 3px;
    margin-left: 12px;
  }

  .player-slot-pip {
    width: 6px;
    height: 6px;
    border-radius: 2px;
  }

  .player-slot-pip.used { background: var(--accent-emerald); }
  .player-slot-pip.empty { background: var(--border); }

  .player-points.top-scorer {
    color: var(--accent-gold);
  }

  /* Footer */
  .footer {
    text-align: center;
    padding: 32px 0;
    border-top: 1px solid var(--border);
    margin-top: 20px;
  }

  .footer p {
    font-size: 12px;
    color: var(--text-muted);
    letter-spacing: 1px;
  }

  .last-updated {
    font-size: 11px;
    color: var(--text-muted);
    margin-top: 4px;
  }

  /* Mobile */
  @media (max-width: 768px) {
    .podium-section {
      gap: 8px;
      padding: 0 8px;
    }
    .podium-card { flex: 0 1 140px; }
    .podium-inner { padding: 16px 10px; }
    .podium-rank { font-size: 28px; }
    .podium-name { font-size: 16px; }
    .podium-points { font-size: 28px; }
    .squads-grid { grid-template-columns: 1fr; }
    .leaderboard-table td { padding: 10px 12px; }
    .header h1 { letter-spacing: 1px; }
  }

  @media (max-width: 480px) {
    .week-bar { gap: 12px; }
    .podium-section { flex-wrap: wrap; }
    .container { padding: 0 12px; }
    .tabs { max-width: 100%; }
  }

  .hidden { display: none; }

  /* Config banner */
  .config-banner {
    background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(34, 211, 238, 0.1));
    border: 1px solid rgba(139, 92, 246, 0.3);
    border-radius: 12px;
    padding: 16px 20px;
    margin-bottom: 24px;
    text-align: center;
    font-size: 13px;
    color: var(--text-secondary);
    display: none;
  }

  .config-banner code {
    background: rgba(0,0,0,0.3);
    padding: 2px 8px;
    border-radius: 4px;
    font-size: 12px;
    color: var(--accent-cyan);
  }
</style>
</head>
<body>

<div class="container">
  <!-- Header -->
  <header class="header">
    <div class="tournament-badge">
      <span class="dot"></span>
      <span>WCT20 2026 ‚Ä¢ Week 4/5</span>
    </div>
    <h1>Rocking Fantasy</h1>
    <p class="subtitle">12 Managers ¬∑ 60 Players ¬∑ <span>1 Champion</span></p>
  </header>

  <!-- Stats Bar -->
  <div class="week-bar">
    <div class="week-stat">
      <span class="icon">üèè</span>
      <span>Matches Played:</span>
      <span class="value" id="matchesPlayed">4/5</span>
    </div>
    <div class="week-stat">
      <span class="icon">‚ö°</span>
      <span>Highest Score:</span>
      <span class="value" id="highestScore">487</span>
    </div>
    <div class="week-stat">
      <span class="icon">üìä</span>
      <span>Avg Points:</span>
      <span class="value" id="avgPoints">297</span>
    </div>
  </div>

  <!-- Podium -->
  <div class="podium-section">
    <div class="podium-card silver" onclick="scrollToSquad('Lagudu')">
      <div class="podium-inner">
        <div class="podium-rank">2</div>
        <div class="podium-name">Lagudu</div>
        <div class="podium-points">409</div>
        <div class="podium-slots">10/10 slots</div>
      </div>
    </div>
    <div class="podium-card gold" onclick="scrollToSquad('Venky')">
      <div class="podium-inner">
        <div class="podium-rank">üèÜ</div>
        <div class="podium-name">Venky</div>
        <div class="podium-points">487</div>
        <div class="podium-slots">10/10 slots</div>
      </div>
    </div>
    <div class="podium-card bronze" onclick="scrollToSquad('Sarath')">
      <div class="podium-inner">
        <div class="podium-rank">3</div>
        <div class="podium-name">Sarath</div>
        <div class="podium-points">343</div>
        <div class="podium-slots">7/10 slots</div>
      </div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab-btn active" onclick="switchTab('leaderboard')">Leaderboard</button>
    <button class="tab-btn" onclick="switchTab('squads')">Squad Details</button>
  </div>

  <!-- Config Banner (shown when no API connected) -->
  <div class="config-banner" id="configBanner">
    üîó To enable live updates, set your Apps Script URL in <code>APPS_SCRIPT_URL</code> at the top of this file.
  </div>

  <!-- Leaderboard Panel -->
  <div id="leaderboardPanel" class="leaderboard-panel">
    <table class="leaderboard-table" id="leaderboardTable">
      <thead>
        <tr>
          <th>#</th>
          <th>Manager</th>
          <th>Points (4/5)</th>
          <th>Total Points</th>
          <th>Slots Used</th>
        </tr>
      </thead>
      <tbody id="leaderboardBody"></tbody>
    </table>
  </div>

  <!-- Squads Panel -->
  <div id="squadsPanel" class="squads-panel hidden">
    <div class="squads-grid" id="squadsGrid"></div>
  </div>

  <!-- Footer -->
  <div class="footer">
    <p>ROCKING FANTASY WCT20 2026</p>
    <p class="last-updated" id="lastUpdated">Last updated: --</p>
  </div>
</div>

<script>
// ====================================================
// CONFIGURATION
// Replace with your deployed Apps Script Web App URL
// to enable live data from Google Sheets.
// Leave empty to use the embedded data below.
// ====================================================
const APPS_SCRIPT_URL = '';
const REFRESH_INTERVAL = 60000; // 60 seconds

// ====================================================
// EMBEDDED DATA (edit this when APPS_SCRIPT_URL is empty)
// ====================================================
const STATIC_DATA = {
  weekInfo: { week: "4/5", totalWeeks: 5 },
  managers: [
    {
      rank: 1, name: "Venky", totalPoints: 487, slotsUsed: 10,
      players: [
        { name: "Azmatullah Omarzai", points: 158, slots: 2 },
        { name: "Aiden Markram", points: 119, slots: 2 },
        { name: "Shadab Khan", points: 115, slots: 2 },
        { name: "Ishan Kishan", points: 95, slots: 2 },
        { name: "Jacob Bethell", points: 60, slots: 2 },
      ]
    },
    {
      rank: 2, name: "Lagudu", totalPoints: 409, slotsUsed: 10,
      players: [
        { name: "Shivam Dube", points: 143, slots: 2 },
        { name: "Saim Ayub", points: 95, slots: 2 },
        { name: "Travis Head", points: 88, slots: 2 },
        { name: "Mohammad Nabi", points: 83, slots: 2 },
        { name: "Glenn Maxwell", points: 62, slots: 2 },
      ]
    },
    {
      rank: 3, name: "Sarath", totalPoints: 343, slotsUsed: 7,
      players: [
        { name: "Pathum Nissanka", points: 167, slots: 2 },
        { name: "Marco Jansen", points: 80, slots: 1 },
        { name: "Rashid Khan", points: 60, slots: 2 },
        { name: "Dasun Shanaka", points: 36, slots: 2 },
        { name: "Romario Shepherd", points: 0, slots: 0 },
      ]
    },
    {
      rank: 4, name: "Vamsi", totalPoints: 309, slotsUsed: 8,
      players: [
        { name: "Sahibzada Farhan", points: 100, slots: 2 },
        { name: "Gerhard Erasmus", points: 78, slots: 2 },
        { name: "Tilak Varma", points: 76, slots: 2 },
        { name: "George Dockrell", points: 55, slots: 1 },
        { name: "Sherfane Rutherford", points: 24, slots: 1 },
      ]
    },
    {
      rank: 5, name: "Vivek", totalPoints: 307, slotsUsed: 9,
      players: [
        { name: "Sam Curran", points: 143, slots: 2 },
        { name: "Jason Holder", points: 94, slots: 2 },
        { name: "Akeal Hosein", points: 40, slots: 2 },
        { name: "Philip Salt", points: 30, slots: 2 },
        { name: "Arshdeep Singh", points: 0, slots: 1 },
      ]
    },
    {
      rank: 6, name: "Sandeep", totalPoints: 282, slotsUsed: 9,
      players: [
        { name: "Shai Hope", points: 151, slots: 2 },
        { name: "Kusal Mendis", points: 65, slots: 2 },
        { name: "Blessing Muzarabani", points: 40, slots: 1 },
        { name: "Brandon King", points: 26, slots: 2 },
        { name: "Tim Seifert", points: 19, slots: 2 },
      ]
    },
    {
      rank: 7, name: "Pikun", totalPoints: 256, slotsUsed: 10,
      players: [
        { name: "Adam Zampa", points: 81, slots: 2 },
        { name: "Suryakumar Yadav", points: 66, slots: 2 },
        { name: "Jasprit Bumrah", points: 60, slots: 2 },
        { name: "Roston Chase", points: 49, slots: 2 },
        { name: "Abhishek Sharma", points: 0, slots: 2 },
      ]
    },
    {
      rank: 8, name: "Vinay", totalPoints: 256, slotsUsed: 9,
      players: [
        { name: "Adil Rashid", points: 80, slots: 2 },
        { name: "Finn Allen", points: 52, slots: 2 },
        { name: "Quinton de Kock", points: 44, slots: 2 },
        { name: "Gudakesh Motie", points: 40, slots: 2 },
        { name: "Axar Patel", points: 40, slots: 1 },
      ]
    },
    {
      rank: 9, name: "Varma", totalPoints: 241, slotsUsed: 6,
      players: [
        { name: "Varun Chakaravarthy", points: 105, slots: 2 },
        { name: "Ryan Rickelton", points: 61, slots: 2 },
        { name: "Sikandar Raza", points: 45, slots: 1 },
        { name: "Shubham Ranjane", points: 30, slots: 1 },
        { name: "Matt Renshaw", points: 0, slots: 0 },
      ]
    },
    {
      rank: 10, name: "Loya", totalPoints: 236, slotsUsed: 10,
      players: [
        { name: "Hardik Pandya", points: 95, slots: 2 },
        { name: "Glenn Phillips", points: 92, slots: 2 },
        { name: "Maheesh Theekshana", points: 25, slots: 2 },
        { name: "Mohammad Nawaz", points: 24, slots: 2 },
        { name: "Cameron Green", points: 8, slots: 2 },
      ]
    },
    {
      rank: 11, name: "Sravan", totalPoints: 225, slotsUsed: 9,
      players: [
        { name: "Rachin Ravindra", points: 92, slots: 2 },
        { name: "Salman Agha", points: 62, slots: 2 },
        { name: "Rahmanullah Gurbaz", points: 40, slots: 2 },
        { name: "George Munsey", points: 31, slots: 2 },
        { name: "Lungi Ngidi", points: 20, slots: 1 },
      ]
    },
    {
      rank: 12, name: "Sriram", totalPoints: 210, slotsUsed: 8,
      players: [
        { name: "Mujeeb Ur Rahman", points: 70, slots: 2 },
        { name: "Shimron Hetmyer", points: 52, slots: 2 },
        { name: "Shaheen Afridi", points: 48, slots: 1 },
        { name: "Shadley van Schalkwyk", points: 40, slots: 1 },
        { name: "Jos Buttler", points: 16, slots: 2 },
      ]
    },
  ]
};

// ====================================================
// APP LOGIC
// ====================================================
let currentData = null;

function init() {
  if (APPS_SCRIPT_URL) {
    fetchLiveData();
    setInterval(fetchLiveData, REFRESH_INTERVAL);
  } else {
    currentData = STATIC_DATA;
    render(currentData);
    document.getElementById('lastUpdated').textContent = 'Static data ¬∑ Edit index.html to update';
  }
}

async function fetchLiveData() {
  try {
    const res = await fetch(APPS_SCRIPT_URL);
    const data = await res.json();
    currentData = data;
    render(data);
    document.getElementById('lastUpdated').textContent =
      'Last updated: ' + new Date().toLocaleString();
  } catch (err) {
    console.error('Fetch error:', err);
    if (!currentData) {
      currentData = STATIC_DATA;
      render(STATIC_DATA);
    }
  }
}

function render(data) {
  renderStats(data);
  renderLeaderboard(data.managers);
  renderSquads(data.managers);
}

function renderStats(data) {
  const managers = data.managers;
  const highest = Math.max(...managers.map(m => m.totalPoints));
  const avg = Math.round(managers.reduce((s, m) => s + m.totalPoints, 0) / managers.length);
  document.getElementById('highestScore').textContent = highest;
  document.getElementById('avgPoints').textContent = avg;
}

function renderLeaderboard(managers) {
  const maxPoints = Math.max(...managers.map(m => m.totalPoints));
  const tbody = document.getElementById('leaderboardBody');
  tbody.innerHTML = managers.map((m, i) => {
    // Sum actual player total for total points column
    const playerTotal = m.players.reduce((s, p) => s + p.points, 0);
    const barWidth = (m.totalPoints / maxPoints * 100).toFixed(1);
    return `
      <tr onclick="switchTab('squads'); setTimeout(() => scrollToSquad('${m.name}'), 100)">
        <td class="rank-cell ${i < 3 ? 'top3' : ''}">${i < 3 ? ['ü•á','ü•à','ü•â'][i] : m.rank}</td>
        <td class="manager-cell">${m.name}</td>
        <td class="points-cell">
          ${m.totalPoints}
          <div class="points-bar"><div class="points-bar-fill" style="width:${barWidth}%"></div></div>
        </td>
        <td class="total-points-cell">${playerTotal}</td>
        <td class="slots-cell">
          <div class="slots-bar">
            ${Array.from({length: 10}, (_, j) =>
              `<div class="slot-pip ${j < m.slotsUsed ? 'used' : ''}"></div>`
            ).join('')}
          </div>
          <span style="font-size:11px;color:var(--text-muted)">${m.slotsUsed}/10</span>
        </td>
      </tr>
    `;
  }).join('');
}

function renderSquads(managers) {
  const globalMax = Math.max(...managers.flatMap(m => m.players.map(p => p.points)));
  const grid = document.getElementById('squadsGrid');
  grid.innerHTML = managers.map((m) => {
    const playerTotal = m.players.reduce((s, p) => s + p.points, 0);
    return `
      <div class="squad-card" data-manager="${m.name}" id="squad-${m.name}">
        <div class="squad-header">
          <div class="squad-header-left">
            <div class="squad-rank-badge">#${m.rank}</div>
            <div class="squad-manager-name">${m.name}</div>
          </div>
          <div class="squad-total">
            ${m.totalPoints}
            <small>PTS (${m.slotsUsed}/10 slots)</small>
          </div>
        </div>
        <div class="squad-players">
          ${m.players.map(p => `
            <div class="squad-player">
              <span class="player-name">${p.name}</span>
              <span class="player-points ${p.points === globalMax ? 'top-scorer' : ''}">${p.points}</span>
              <div class="player-slots">
                ${Array.from({length: 2}, (_, j) =>
                  `<div class="player-slot-pip ${j < p.slots ? 'used' : 'empty'}"></div>`
                ).join('')}
              </div>
            </div>
          `).join('')}
        </div>
      </div>
    `;
  }).join('');
}

function switchTab(tab) {
  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
  if (tab === 'leaderboard') {
    document.querySelectorAll('.tab-btn')[0].classList.add('active');
    document.getElementById('leaderboardPanel').classList.remove('hidden');
    document.getElementById('squadsPanel').classList.add('hidden');
  } else {
    document.querySelectorAll('.tab-btn')[1].classList.add('active');
    document.getElementById('leaderboardPanel').classList.add('hidden');
    document.getElementById('squadsPanel').classList.remove('hidden');
  }
}

function scrollToSquad(name) {
  const el = document.getElementById('squad-' + name);
  if (el) {
    el.scrollIntoView({ behavior: 'smooth', block: 'center' });
    el.style.borderColor = 'rgba(245, 166, 35, 0.5)';
    setTimeout(() => el.style.borderColor = '', 2000);
  }
}

// Init
document.addEventListener('DOMContentLoaded', init);
</script>
</body>
</html>
